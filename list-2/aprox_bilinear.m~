function [Res] = aprox_bilinear(im_in,im_ref)

%{
p1r = [088 134]; // Centro da unha do indicador
p1i = [106 302]; // Centro da unha do indicador
p2r = [459 129]; // Centro da unha do minguinho
p2i = [345 173]; // Centro da unha do minguinho
p3r = [252 526]; // Junção das veias próximas ao polegar
p3i = [287 500]; // Junção das veias próximas ao polegar
p4r = [033 414]; // Base da unha do polegar
p4i = [130 500]; // Base da unha do polegar
%}

[nl nc] = size(im_in);
Res = zeros(nl,nc);
M = zeros(8,8);

pf = [134;129;526;414;088;459;252;033];
pi = [302;173;500;500;106;345;287;130];

for i=1:1:4
    M(i,1) = pi(i);
    M(i,2) = pi(i+4);
    M(i,3) = pi(i)*pi(i+4);
    M(i,4) = 1;
    M(i+4,5) = pi(i);
    M(i+4,6) = pi(i+4);
    M(i+4,7) = pi(i)*pi(i+4);
    M(i+4,8) = pi(1);
end

%{
M = [302 106 302*106 1 0 0 0 0;
     173 345 173*345 1 0 0 0 0;
     500 287 500*287 1 0 0 0 0;
     500 130 500*130 1 0 0 0 0;
     0 0 0 0 302 106 302*106 1;
     0 0 0 0 173 345 173*345 1;
     0 0 0 0 500 287 500*287 1;
     0 0 0 0 5-00 130 500*130 1];
%} 
 w = zeros(8,1);
 
 w = inv(M) * pf;
 
 for i = 1:1:nl
    for j = 1:1:nc
        cf = abs(round(w(1)))*j + abs(round(w(2)))*i + abs(round(w(3)))*j*i + abs(round(w(4)));
        lf = abs(round(w(5)))*j + abs(round(w(6)))*i + abs(round(w(7)))*j*i + abs(round(w(8)));
        Res(lf,cf) = im_in(i,j);
    end
 end
 
end

